<% layout("/layouts/boilerplate") -%>
<style>

</style>

<body>
 
    <div id="filterbar">
     
      <a href="/listings" class="filter <%= selectedCategory === '' ? 'active' : '' %>">
        <i class="fa-solid fa-house"></i>
        <span>All</span>
      </a>

      <a href="/listings?category=tranding" class="filter <%= selectedCategory === 'tranding' ? 'active' : '' %>">
        <i class="fa-solid fa-fire"></i>
        <span>Trending</span>
      </a>

      <a href="/listings?category=rooms" class="filter <%= selectedCategory === 'rooms' ? 'active' : '' %>">
        <i class="fa-solid fa-bed"></i>
        <span>Rooms</span>
      </a>

      <a href="/listings?category=iconic city" class="filter <%= selectedCategory === 'iconic city' ? 'active' : '' %>">
        <i class="fa-solid fa-city"></i>
        <span>Iconic city</span>
      </a>

      <a href="/listings?category=mountain" class="filter <%= selectedCategory === 'mountain' ? 'active' : '' %>">
        <i class="fa-solid fa-mountain-city"></i>
        <span>Mountain city</span>
      </a>

      <a href="/listings?category=pool" class="filter <%= selectedCategory === 'pool' ? 'active' : '' %>">
        <i class="fa-solid fa-person-swimming"></i>
        <span>Pool</span>
      </a>

      <a href="/listings?category=castel" class="filter <%= selectedCategory === 'castel' ? 'active' : '' %>">
        <i class="fa-solid fa-landmark-dome"></i>
        <span>Castles</span>
      </a>

      <a href="/listings?category=tranding" class="filter <%= selectedCategory === 'tranding' ? 'active' : '' %>">
        <i class="fa-solid fa-umbrella-beach"></i>
        <span>Beach</span>
      </a>

    <form method="GET" action="/listings" class="filter-form container mt-1">
      <div class="card shadow-sm p-3">
         <div class="row g-3"> 
          <div class="col-md-3"> 
        <input type="number" name="minPrice" class="form-control"
          placeholder="₹ Min price" value="<%= filters.minPrice || '' %>">
      </div>

      <div class="col-md-3">
        <input type="number" name="maxPrice" class="form-control"
          placeholder="₹ Max price" value="<%= filters.maxPrice || '' %>">
      </div>

      <div class="col-md-2">
        <input type="number" name="minRating" class="form-control"
          placeholder="1 - 5" min="1" max="5"
          value="<%= filters.minRating || '' %>">
      </div>

      <div class="col-md-2">
        <input type="number" name="minDiscount" class="form-control"
          placeholder="% Discount"
          value="<%= filters.minDiscount || '' %>">
      </div>

      <div class="col-md-2 d-grid">
        <button type="submit" class="btn btn-dark">
          filter
        </button>
      
      </div>
      

    </div>
  </div>
</form>



    </div>
  
  

  

  <div class="row row-cols-1 row-cols-md-3 row-cols-lg-5 g-6">
    <% for (let listing of listings) { %>
      <div class="col">
        <div class="card h-50 custom-card mx-auto">
          <a href="/listings/<%= listing._id %>" >
            <% if (listing.Img) { %>
              <% let imgSrc = '/images/placeholder.jpg'; %>
              <% if (typeof listing.Img === 'object' && listing.Img.url) { %>
                <% imgSrc = listing.Img.url; %>
              <% } else if (typeof listing.Img === 'string') { %>
                <% imgSrc = listing.Img; %>
              <% } %>
              <img src="<%= imgSrc %>" class="card-img-top listing-img" alt="<%= listing.Title %>">
            <% } else { %>
              <img src="/images/placeholder.jpg" class="card-img-top listing-img" alt="placeholder">
            <% } %>
          </a>
          <div class="card-img-overlay">
            <div class="box" >Guest favourite </div>
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-heart" viewBox="0 0 16 16" style="margin-left:11.5rem ; margin-top:-1.5rem;opacity:0.6;">
                <path d="m8 2.748-.717-.737C5.6.281 2.514.878 1.4 3.053c-.523 1.023-.641 2.5.314 4.385.92 1.815 2.834 3.989 6.286 6.357 3.452-2.368 5.365-4.542 6.286-6.357.955-1.886.838-3.362.314-4.385C13.486.878 10.4.28 8.717 2.01zM8 15C-7.333 4.868 3.279-3.04 7.824 1.143q.09.083.176.171a3 3 0 0 1 .176-.17C12.72-3.042 23.333 4.867 8 15"/>
</svg>
          </div>
          <div class="card-body">
            <h5 class="card-title mb-1">
              <a href="/listings/<%= listing._id %>" class="text-decoration-none text-dark"><%= listing.Title %></a>
            </h5>
            <p class="card-text mb-0">
              <%= new Intl.NumberFormat('hi-IN', { style: 'currency', currency: 'INR', maximumFractionDigits: 0 }).format(Number(listing.price) || 0) %>/night
            </p>
          </div>
        </div>
      </div>
    <% } %>
  </div>
</body>

