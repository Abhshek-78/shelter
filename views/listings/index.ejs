<% layout("/layouts/boilerplate") -%>
<body>
  <h1 class="my-4">Popular home</h1>

  <div class="row row-cols-1 row-cols-md-3 row-cols-lg-5 g-6">
    <% for (let listing of listings) { %>
      <div class="col">
        <div class="card h-50 custom-card mx-auto">
          <a href="/listings/<%= listing._id %>" >
            <% if (listing.Img) { %>
              <% let imgSrc = '/images/placeholder.jpg'; %>
              <% if (typeof listing.Img === 'object' && listing.Img.url) { %>
                <% imgSrc = listing.Img.url; %>
              <% } else if (typeof listing.Img === 'string') { %>
                <% imgSrc = listing.Img; %>
              <% } %>
              <img src="<%= imgSrc %>" class="card-img-top listing-img" alt="<%= listing.Title %>">
            <% } else { %>
              <img src="/images/placeholder.jpg" class="card-img-top listing-img" alt="placeholder">
            <% } %>
          </a>
          <div class="card-img-overlay">
            <div class="box" >Guest favourite </div>
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-heart" viewBox="0 0 16 16" style="margin-left:11.5rem ; margin-top:-1.5rem;opacity:0.6;">
                <path d="m8 2.748-.717-.737C5.6.281 2.514.878 1.4 3.053c-.523 1.023-.641 2.5.314 4.385.92 1.815 2.834 3.989 6.286 6.357 3.452-2.368 5.365-4.542 6.286-6.357.955-1.886.838-3.362.314-4.385C13.486.878 10.4.28 8.717 2.01zM8 15C-7.333 4.868 3.279-3.04 7.824 1.143q.09.083.176.171a3 3 0 0 1 .176-.17C12.72-3.042 23.333 4.867 8 15"/>
</svg>
          </div>
          <div class="card-body">
            <h5 class="card-title mb-1">
              <a href="/listings/<%= listing._id %>" class="text-decoration-none text-dark"><%= listing.Title %></a>
            </h5>
            <p class="card-text mb-0">
              <%= new Intl.NumberFormat('hi-IN', { style: 'currency', currency: 'INR', maximumFractionDigits: 0 }).format(Number(listing.price) || 0) %>/night
            </p>
          </div>
        </div>
      </div>
    <% } %>
  </div>
</body>